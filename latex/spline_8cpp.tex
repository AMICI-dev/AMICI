\hypertarget{spline_8cpp}{}\doxysubsection{spline.\+cpp File Reference}
\label{spline_8cpp}\index{spline.cpp@{spline.cpp}}


definition of spline functions  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int {\bfseries spline} (int n, int end1, int end2, double slope1, double slope2, double x\mbox{[}$\,$\mbox{]}, double y\mbox{[}$\,$\mbox{]}, double b\mbox{[}$\,$\mbox{]}, double c\mbox{[}$\,$\mbox{]}, double d\mbox{[}$\,$\mbox{]})
\item 
double {\bfseries seval} (int n, double u, double x\mbox{[}$\,$\mbox{]}, double y\mbox{[}$\,$\mbox{]}, double b\mbox{[}$\,$\mbox{]}, double c\mbox{[}$\,$\mbox{]}, double d\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Evaluate the cubic spline function. \end{DoxyCompactList}\item 
double {\bfseries sinteg} (int n, double u, double x\mbox{[}$\,$\mbox{]}, double y\mbox{[}$\,$\mbox{]}, double b\mbox{[}$\,$\mbox{]}, double c\mbox{[}$\,$\mbox{]}, double d\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
\begin{DoxyAuthor}{Author}
Peter \& Nigel, Design Software, 42 Gubberley St, Kenmore, 4069, Australia. 
\end{DoxyAuthor}


\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{spline_8h_aa6801bbdb0c7625719c019ac287be29e}\label{spline_8h_aa6801bbdb0c7625719c019ac287be29e}} 
\index{spline.cpp@{spline.cpp}!spline@{spline}}
\index{spline@{spline}!spline.cpp@{spline.cpp}}
\doxyparagraph{\texorpdfstring{spline()}{spline()}}
{\footnotesize\ttfamily int spline (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{int}]{end1,  }\item[{int}]{end2,  }\item[{double}]{slope1,  }\item[{double}]{slope2,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{y\mbox{[}$\,$\mbox{]},  }\item[{double}]{b\mbox{[}$\,$\mbox{]},  }\item[{double}]{c\mbox{[}$\,$\mbox{]},  }\item[{double}]{d\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

Evaluate the coefficients b\mbox{[}i\mbox{]}, c\mbox{[}i\mbox{]}, d\mbox{[}i\mbox{]}, i = 0, 1, .. n-\/1 for a cubic interpolating spline

S(xx) = Y\mbox{[}i\mbox{]} + b\mbox{[}i\mbox{]} $\ast$ w + c\mbox{[}i\mbox{]} $\ast$ w$\ast$$\ast$2 + d\mbox{[}i\mbox{]} $\ast$ w$\ast$$\ast$3 where w = xx -\/ x\mbox{[}i\mbox{]} and x\mbox{[}i\mbox{]} $<$= xx $<$= x\mbox{[}i+1\mbox{]}

The n supplied data points are x\mbox{[}i\mbox{]}, y\mbox{[}i\mbox{]}, i = 0 ... n-\/1.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n} & The number of data points or knots (n $>$= 2) \\
\hline
\mbox{\texttt{ in}}  & {\em end1} & 0\+: default condition 1\+: specify the slopes at x\mbox{[}0\mbox{]} \\
\hline
\mbox{\texttt{ in}}  & {\em end2} & 0\+: default condition 1\+: specify the slopes at x\mbox{[}n-\/1\mbox{]} \\
\hline
\mbox{\texttt{ in}}  & {\em slope1} & slope at x\mbox{[}0\mbox{]} \\
\hline
\mbox{\texttt{ in}}  & {\em slope2} & slope at x\mbox{[}n-\/1\mbox{]} \\
\hline
\mbox{\texttt{ in}}  & {\em x\mbox{[}$\,$\mbox{]}} & the abscissas of the knots in strictly increasing order \\
\hline
\mbox{\texttt{ in}}  & {\em y\mbox{[}$\,$\mbox{]}} & the ordinates of the knots \\
\hline
\mbox{\texttt{ out}}  & {\em b\mbox{[}$\,$\mbox{]}} & array of spline coefficients \\
\hline
\mbox{\texttt{ out}}  & {\em c\mbox{[}$\,$\mbox{]}} & array of spline coefficients \\
\hline
\mbox{\texttt{ out}}  & {\em d\mbox{[}$\,$\mbox{]}} & array of spline coefficients\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & normal return \\
\hline
{\em 1} & less than two data points; cannot interpolate \\
\hline
{\em 2} & x\mbox{[}\mbox{]} are not in ascending order\\
\hline
\end{DoxyRetVals}
\hypertarget{spline_8h_autotoc_md112}{}\doxyparagraph{Notes}\label{spline_8h_autotoc_md112}

\begin{DoxyItemize}
\item The accompanying function seval() may be used to evaluate the spline while deriv will provide the first derivative.
\item Using p to denote differentiation y\mbox{[}i\mbox{]} = S(\+X\mbox{[}i\mbox{]}) b\mbox{[}i\mbox{]} = Sp(\+X\mbox{[}i\mbox{]}) c\mbox{[}i\mbox{]} = Spp(\+X\mbox{[}i\mbox{]})/2 d\mbox{[}i\mbox{]} = Sppp(\+X\mbox{[}i\mbox{]})/6 ( Derivative from the right )
\item Since the zero elements of the arrays A\+RE N\+OW used here, all arrays to be passed from the main program should be dimensioned at least \mbox{[}n\mbox{]}. These routines will use elements \mbox{[}0 .. n-\/1\mbox{]}.
\item Adapted from the text Forsythe, G.\+E., Malcolm, M.\+A. and Moler, C.\+B. (1977) \char`\"{}\+Computer Methods for Mathematical Computations\char`\"{} Prentice Hall
\item Note that although there are only n-\/1 polynomial segments, n elements are requird in b, c, d. The elements b\mbox{[}n-\/1\mbox{]}, c\mbox{[}n-\/1\mbox{]} and d\mbox{[}n-\/1\mbox{]} are set to continue the last segment past x\mbox{[}n-\/1\mbox{]}. 
\end{DoxyItemize}

Definition at line 16 of file spline.\+cpp.

\mbox{\Hypertarget{spline_8h_a20c8c27889853621fba3e0eacd333723}\label{spline_8h_a20c8c27889853621fba3e0eacd333723}} 
\index{spline.cpp@{spline.cpp}!seval@{seval}}
\index{seval@{seval}!spline.cpp@{spline.cpp}}
\doxyparagraph{\texorpdfstring{seval()}{seval()}}
{\footnotesize\ttfamily double seval (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{double}]{u,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{y\mbox{[}$\,$\mbox{]},  }\item[{double}]{b\mbox{[}$\,$\mbox{]},  }\item[{double}]{c\mbox{[}$\,$\mbox{]},  }\item[{double}]{d\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

S(xx) = y\mbox{[}i\mbox{]} + b\mbox{[}i\mbox{]} $\ast$ w + c\mbox{[}i\mbox{]} $\ast$ w$\ast$$\ast$2 + d\mbox{[}i\mbox{]} $\ast$ w$\ast$$\ast$3 where w = u -\/ x\mbox{[}i\mbox{]} and x\mbox{[}i\mbox{]} $<$= u $<$= x\mbox{[}i+1\mbox{]} Note that Horner\textquotesingle{}s rule is used. If u $<$ x\mbox{[}0\mbox{]} then i = 0 is used. If u $>$ x\mbox{[}n-\/1\mbox{]} then i = n-\/1 is used.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n} & The number of data points or knots (n $>$= 2) \\
\hline
\mbox{\texttt{ in}}  & {\em u} & the abscissa at which the spline is to be evaluated \\
\hline
\mbox{\texttt{ in}}  & {\em x\mbox{[}$\,$\mbox{]}} & the abscissas of the knots in strictly increasing order \\
\hline
\mbox{\texttt{ in}}  & {\em y\mbox{[}$\,$\mbox{]}} & the ordinates of the knots \\
\hline
\mbox{\texttt{ in}}  & {\em b} & array of spline coefficients computed by spline(). \\
\hline
\mbox{\texttt{ in}}  & {\em c} & array of spline coefficients computed by spline(). \\
\hline
\mbox{\texttt{ in}}  & {\em d} & array of spline coefficients computed by spline().\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the value of the spline function at u
\end{DoxyReturn}
Notes
\begin{DoxyItemize}
\item If u is not in the same interval as the previous call then a binary search is performed to determine the proper interval. 
\end{DoxyItemize}

Definition at line 195 of file spline.\+cpp.

\mbox{\Hypertarget{spline_8h_a158da90aec69a4796fb6f350ac6b71ab}\label{spline_8h_a158da90aec69a4796fb6f350ac6b71ab}} 
\index{spline.cpp@{spline.cpp}!sinteg@{sinteg}}
\index{sinteg@{sinteg}!spline.cpp@{spline.cpp}}
\doxyparagraph{\texorpdfstring{sinteg()}{sinteg()}}
{\footnotesize\ttfamily double sinteg (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{double}]{u,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{y\mbox{[}$\,$\mbox{]},  }\item[{double}]{b\mbox{[}$\,$\mbox{]},  }\item[{double}]{c\mbox{[}$\,$\mbox{]},  }\item[{double}]{d\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

Integrate the cubic spline function

S(xx) = y\mbox{[}i\mbox{]} + b\mbox{[}i\mbox{]} $\ast$ w + c\mbox{[}i\mbox{]} $\ast$ w$\ast$$\ast$2 + d\mbox{[}i\mbox{]} $\ast$ w$\ast$$\ast$3 where w = u -\/ x\mbox{[}i\mbox{]} and x\mbox{[}i\mbox{]} $<$= u $<$= x\mbox{[}i+1\mbox{]}

The integral is zero at u = x\mbox{[}0\mbox{]}.

If u $<$ x\mbox{[}0\mbox{]} then i = 0 segment is extrapolated. If u $>$ x\mbox{[}n-\/1\mbox{]} then i = n-\/1 segment is extrapolated.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n} & the number of data points or knots (n $>$= 2) \\
\hline
\mbox{\texttt{ in}}  & {\em u} & the abscissa at which the spline is to be evaluated \\
\hline
\mbox{\texttt{ in}}  & {\em x\mbox{[}$\,$\mbox{]}} & the abscissas of the knots in strictly increasing order \\
\hline
\mbox{\texttt{ in}}  & {\em y\mbox{[}$\,$\mbox{]}} & the ordinates of the knots \\
\hline
\mbox{\texttt{ in}}  & {\em b} & array of spline coefficients computed by spline(). \\
\hline
\mbox{\texttt{ in}}  & {\em c} & array of spline coefficients computed by spline(). \\
\hline
\mbox{\texttt{ in}}  & {\em d} & array of spline coefficients computed by spline().\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the value of the spline function at u
\end{DoxyReturn}
Notes
\begin{DoxyItemize}
\item If u is not in the same interval as the previous call then a binary search is performed to determine the proper interval. 
\end{DoxyItemize}

Definition at line 256 of file spline.\+cpp.

