find_package(SWIG REQUIRED)
include(${SWIG_USE_FILE})

FIND_PACKAGE(PythonLibs REQUIRED)
INCLUDE_DIRECTORIES(${PYTHON_INCLUDE_PATH})
INCLUDE_DIRECTORIES(${Amici_DIR}/swig)

SET(CMAKE_SWIG_FLAGS "")
SET_SOURCE_FILES_PROPERTIES(${CMAKE_CURRENT_SOURCE_DIR}/${PROJECT_NAME}.i PROPERTIES CPLUSPLUS ON)
SWIG_ADD_LIBRARY(${PROJECT_NAME} MODULE LANGUAGE python SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/${PROJECT_NAME}.i)
SWIG_LINK_LIBRARIES(${PROJECT_NAME}
	Upstream::amici
	${PYTHON_LIBRARIES} 
	${CMAKE_CURRENT_BINARY_DIR}/../lib${PROJECT_NAME}${CMAKE_STATIC_LIBRARY_SUFFIX})


SET(SETUP_PY_IN ${Amici_DIR}/model_setup.template.py)
SET(SETUP_PY_OUT ${CMAKE_CURRENT_BINARY_DIR}/setup.py)

add_custom_target(install-python
        DEPENDS _${PROJECT_NAME}
        COMMAND python ${SETUP_PY_OUT} install)
